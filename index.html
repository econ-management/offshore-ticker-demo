<!doctype html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Norsk sokkel â€“ Bidrag til fellesskapet</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,500;0,9..40,700;1,9..40,400&family=DM+Serif+Display&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #050810;
      --text: #f4f6fb;
      --muted: #8a94a8;
      --accent: #3b82f6;
      --accent-glow: rgba(59, 130, 246, 0.4);
      --gold: #f59e0b;
      --card: rgba(255,255,255,0.03);
      --card-border: rgba(255,255,255,0.08);
      --line: rgba(255,255,255,0.1);
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'DM Sans', system-ui, sans-serif;
      color: var(--text);
      background: 
        radial-gradient(ellipse 120% 80% at 10% 0%, rgba(30, 58, 138, 0.3) 0%, transparent 50%),
        radial-gradient(ellipse 80% 60% at 90% 20%, rgba(14, 116, 144, 0.2) 0%, transparent 50%),
        radial-gradient(ellipse 100% 80% at 50% 100%, rgba(88, 28, 135, 0.15) 0%, transparent 50%),
        var(--bg);
      min-height: 100vh;
      line-height: 1.5;
    }
    .wrap { max-width: 1280px; margin: 0 auto; padding: 16px 16px 32px; }
    
    /* Header - mer kompakt */
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      flex-wrap: wrap;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--line);
    }
    .brand { display: flex; align-items: center; gap: 14px; }
    .logo-container {
      width: 56px; height: 56px;
      background: white;
      border-radius: 12px;
      display: flex; align-items: center; justify-content: center;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      overflow: hidden;
      padding: 6px;
    }
    .logo-container img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
    .brand-text h1 {
      font-family: 'DM Serif Display', serif;
      font-size: 1.4rem;
      font-weight: 400;
      letter-spacing: -0.02em;
    }
    .brand-text p {
      color: var(--muted);
      font-size: 0.8rem;
      margin-top: 2px;
    }
    .header-actions { display: flex; gap: 8px; flex-wrap: wrap; }
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 12px;
      border-radius: 8px;
      font-size: 0.8rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
      text-decoration: none;
    }
    .btn-primary {
      background: var(--accent);
      color: white;
      box-shadow: 0 4px 16px var(--accent-glow);
    }
    .btn-primary:hover { transform: translateY(-1px); }
    .btn-secondary {
      background: var(--card);
      color: var(--text);
      border: 1px solid var(--card-border);
    }
    .btn-secondary:hover { background: rgba(255,255,255,0.08); }
    .btn svg { width: 16px; height: 16px; }

    /* Start-banner */
    .start-banner {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 10px 16px;
      background: rgba(245, 158, 11, 0.1);
      border: 1px solid rgba(245, 158, 11, 0.2);
      border-radius: 10px;
      margin-bottom: 16px;
      font-size: 0.8rem;
      color: var(--gold);
    }
    .start-banner strong { color: #fbbf24; }

    /* Hero ticker - hovedtall stort og tydelig */
    .hero-ticker {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(59, 130, 246, 0.02) 100%);
      border: 1px solid rgba(59, 130, 246, 0.2);
      border-radius: 16px;
      padding: 20px 24px;
      margin-bottom: 16px;
      text-align: center;
    }
    .hero-label {
      font-size: 0.85rem;
      color: var(--muted);
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .hero-label svg { width: 20px; height: 20px; opacity: 0.7; }
    .hero-value {
      font-family: 'DM Serif Display', serif;
      font-size: 2.8rem;
      font-weight: 400;
      line-height: 1.1;
      letter-spacing: -0.02em;
      background: linear-gradient(135deg, #fff 0%, #a5b4fc 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    @media (max-width: 600px) { .hero-value { font-size: 1.8rem; } }
    .hero-delta {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-top: 10px;
      padding: 5px 12px;
      background: rgba(59, 130, 246, 0.15);
      border-radius: 20px;
      font-size: 0.75rem;
      color: var(--accent);
    }

    /* Kompakt 5-grid for hovedtall */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 12px;
      margin-bottom: 16px;
    }
    @media (max-width: 1000px) { .stats-grid { grid-template-columns: repeat(3, 1fr); } }
    @media (max-width: 700px) { .stats-grid { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 450px) { .stats-grid { grid-template-columns: 1fr; } }
    
    .stat-card {
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: 14px;
      padding: 16px;
      position: relative;
      overflow: hidden;
    }
    .stat-card::before {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.08), transparent);
    }
    .stat-icon {
      width: 36px; height: 36px;
      background: rgba(255,255,255,0.05);
      border-radius: 10px;
      display: flex; align-items: center; justify-content: center;
      margin-bottom: 10px;
    }
    .stat-icon svg { width: 20px; height: 20px; opacity: 0.85; }
    .stat-label {
      font-size: 0.75rem;
      color: var(--muted);
      margin-bottom: 4px;
      line-height: 1.3;
    }
    .stat-value {
      font-family: 'DM Serif Display', serif;
      font-size: 1.4rem;
      font-weight: 400;
      line-height: 1.2;
    }
    @media (max-width: 600px) { .stat-value { font-size: 1.2rem; } }
    .stat-sub {
      font-size: 0.7rem;
      color: var(--muted);
      margin-top: 6px;
    }
    .stat-delta {
      display: inline-block;
      margin-top: 6px;
      padding: 3px 8px;
      background: rgba(59, 130, 246, 0.1);
      border-radius: 12px;
      font-size: 0.65rem;
      color: var(--accent);
    }

    /* Tilsvarer - kompakt linje */
    .comparison-bar {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 16px;
    }
    .comp-item {
      flex: 1;
      min-width: 140px;
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: 10px;
      padding: 12px 14px;
      text-align: center;
    }
    .comp-value {
      font-family: 'DM Serif Display', serif;
      font-size: 1.3rem;
      color: var(--gold);
    }
    .comp-label {
      font-size: 0.7rem;
      color: var(--muted);
      margin-top: 2px;
    }

    /* Seksjonsdeler */
    .section-title {
      font-size: 0.75rem;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin: 20px 0 12px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .section-title::after {
      content: '';
      flex: 1;
      height: 1px;
      background: var(--line);
    }

    /* Fields - kompakt */
    .fields-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 8px;
      margin-bottom: 16px;
    }
    @media (max-width: 900px) { .fields-grid { grid-template-columns: repeat(3, 1fr); } }
    @media (max-width: 500px) { .fields-grid { grid-template-columns: repeat(2, 1fr); } }
    .field-item {
      padding: 10px;
      background: var(--card);
      border-radius: 10px;
      border: 1px solid var(--card-border);
      text-align: center;
    }
    .field-name {
      font-size: 0.7rem;
      font-weight: 500;
      margin-bottom: 6px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .field-bar {
      height: 4px;
      background: rgba(255,255,255,0.1);
      border-radius: 2px;
      overflow: hidden;
      margin-bottom: 6px;
    }
    .field-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent), #06b6d4);
      border-radius: 2px;
    }
    .field-value {
      font-size: 0.65rem;
      color: var(--muted);
    }

    /* Historical - kompakt */
    .historical {
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.08) 0%, rgba(245, 158, 11, 0.02) 100%);
      border: 1px solid rgba(245, 158, 11, 0.15);
      border-radius: 12px;
      padding: 14px 18px;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 14px;
    }
    .historical-icon {
      width: 40px; height: 40px;
      background: rgba(245, 158, 11, 0.12);
      border-radius: 10px;
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0;
    }
    .historical-icon svg { width: 22px; height: 22px; }
    .historical-text { font-size: 0.85rem; }
    .historical-text strong { color: var(--gold); }

    /* Footer */
    .footer-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 10px;
    }
    .meta-pill {
      padding: 6px 10px;
      background: var(--card);
      border: 1px solid var(--card-border);
      border-radius: 16px;
      font-size: 0.7rem;
      color: var(--muted);
    }
    .meta-pill strong { color: var(--text); }
    .footer-note {
      font-size: 0.65rem;
      color: var(--muted);
      opacity: 0.6;
    }

    /* Toast */
    #toast {
      position: fixed;
      left: 50%; top: 16px;
      transform: translateX(-50%) translateY(-10px);
      padding: 10px 16px;
      background: rgba(0,0,0,0.9);
      border: 1px solid var(--accent);
      border-radius: 10px;
      font-size: 0.8rem;
      color: var(--text);
      opacity: 0;
      pointer-events: none;
      transition: all 0.3s ease;
      z-index: 1000;
      box-shadow: 0 8px 32px rgba(0,0,0,0.5);
    }
    #toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

    /* Modal */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(4px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      padding: 20px;
    }
    .modal-overlay.show { display: flex; }
    .modal {
      background: var(--bg);
      border: 1px solid var(--card-border);
      border-radius: 16px;
      padding: 24px;
      max-width: 500px;
      width: 100%;
    }
    .modal h3 {
      font-family: 'DM Serif Display', serif;
      font-size: 1.3rem;
      margin-bottom: 10px;
    }
    .modal p { color: var(--muted); font-size: 0.85rem; margin-bottom: 16px; }
    .modal textarea {
      width: 100%;
      height: 100px;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--line);
      border-radius: 10px;
      padding: 12px;
      color: var(--text);
      font-family: monospace;
      font-size: 0.75rem;
      resize: none;
      margin-bottom: 12px;
    }
    .modal-actions { display: flex; gap: 10px; justify-content: flex-end; }

    /* Animations */
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
    .pulse { animation: pulse 0.4s ease; }
  </style>
</head>
<body>
  <div id="toast"></div>

  <div class="modal-overlay" id="embedModal">
    <div class="modal">
      <h3>Embed tikkeren</h3>
      <p>Kopier koden for Ã¥ vise pÃ¥ din nettside:</p>
      <textarea readonly id="embedCode">&lt;iframe src="https://norsk-sokkel-tikker.netlify.app/" width="100%" height="700" frameborder="0"&gt;&lt;/iframe&gt;</textarea>
      <div class="modal-actions">
        <button class="btn btn-secondary" onclick="closeEmbed()">Lukk</button>
        <button class="btn btn-primary" onclick="copyEmbed()">Kopier</button>
      </div>
    </div>
  </div>

  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo-container">
          <!-- Offshore Norge logo -->
          <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect fill='%23003366' width='100' height='100'/%3E%3Ctext x='50' y='35' text-anchor='middle' fill='white' font-family='Arial' font-weight='bold' font-size='12'%3EOFFSHORE%3C/text%3E%3Ctext x='50' y='55' text-anchor='middle' fill='white' font-family='Arial' font-weight='bold' font-size='14'%3ENORGE%3C/text%3E%3Cpath d='M25 70 L50 80 L75 70' stroke='%2300A3E0' stroke-width='3' fill='none'/%3E%3Ccircle cx='50' cy='75' r='3' fill='%2300A3E0'/%3E%3C/svg%3E" alt="Offshore Norge" />
        </div>
        <div class="brand-text">
          <h1>Norsk sokkels bidrag til fellesskapet</h1>
          <p>Sanntidsvisning 2024</p>
        </div>
      </div>
      <div class="header-actions">
        <button class="btn btn-primary" onclick="shareLinkedIn()">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
          Del
        </button>
        <button class="btn btn-secondary" onclick="openEmbed()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
          Embed
        </button>
      </div>
    </header>

    <!-- Startdato-banner -->
    <div class="start-banner">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
        <rect x="3" y="4" width="18" height="18" rx="2"/>
        <path d="M16 2v4M8 2v4M3 10h18"/>
      </svg>
      Teller fra <strong>1. oktober 2024</strong> â€“ oppdateres hvert sekund
    </div>

    <!-- HERO: Netto kontantstrÃ¸m -->
    <div class="hero-ticker">
      <div class="hero-label">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2v20M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"/>
        </svg>
        Netto kontantstrÃ¸m til Statens pensjonsfond utland
      </div>
      <div class="hero-value" id="money">â€”</div>
      <div class="hero-delta">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/></svg>
        <span id="taxDelta">+â€¦ kr/s</span>
      </div>
    </div>

    <!-- 4 hovedtall -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">
          <!-- Pensjon/eldre ikon -->
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <circle cx="12" cy="7" r="4"/>
            <path d="M5.5 21v-2a6.5 6.5 0 0113 0v2"/>
            <path d="M15 11l2 2 4-4" stroke="var(--gold)"/>
          </svg>
        </div>
        <div class="stat-label">Finansierte pensjonsÃ¥r</div>
        <div class="stat-value" id="pensions">â€”</div>
        <div class="stat-delta" id="pensionDelta">+â€¦ /min</div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <!-- Bil/transport ikon -->
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <path d="M5 17h14M5 17l1.5-5h11l1.5 5M5 17v2h2v-2m10 0v2h2v-2"/>
            <circle cx="7.5" cy="17" r="1.5" fill="currentColor"/>
            <circle cx="16.5" cy="17" r="1.5" fill="currentColor"/>
            <path d="M9 12V9M15 12V9"/>
          </svg>
        </div>
        <div class="stat-label">BilkjÃ¸ring fra olje</div>
        <div class="stat-value" id="laps">â€”</div>
        <div class="stat-sub" id="wowOsloTrd">â€”</div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <!-- Hus/oppvarming ikon -->
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <path d="M3 10.5L12 4l9 6.5"/>
            <path d="M5 9.5V20h14V9.5"/>
            <path d="M12 20v-6"/>
            <path d="M9 15h6"/>
            <path d="M10 11a2 2 0 104 0" stroke="var(--gold)"/>
          </svg>
        </div>
        <div class="stat-label">Husstander varmet opp (Ã¥rsforbruk)</div>
        <div class="stat-value" id="hhCount">â€”</div>
        <div class="stat-sub" id="hhPct">â€”</div>
        <div class="stat-delta" id="hhDelta">+â€¦ /s</div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <!-- Kalender/dager ikon -->
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <rect x="3" y="4" width="18" height="18" rx="2"/>
            <path d="M16 2v4M8 2v4M3 10h18"/>
            <path d="M8 14h.01M12 14h.01M16 14h.01M8 18h.01M12 18h.01" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="stat-label">Husstand-dager levert</div>
        <div class="stat-value" id="hhDays">â€”</div>
        <div class="stat-sub">Daglig energibehov dekket</div>
        <div class="stat-delta" id="hhDaysDelta">+â€¦ /s</div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <!-- Jordklode/ekvator ikon -->
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <circle cx="12" cy="12" r="9"/>
            <ellipse cx="12" cy="12" rx="9" ry="4"/>
            <path d="M12 3v18"/>
          </svg>
        </div>
        <div class="stat-label">Runder rundt ekvator</div>
        <div class="stat-value" id="km">â€”</div>
        <div class="stat-sub">fra oljeproduksjonen</div>
      </div>
    </div>

    <!-- Tilsvarer-linje -->
    <div class="comparison-bar">
      <div class="comp-item">
        <div class="comp-value" id="compBudget">â€”</div>
        <div class="comp-label">av statsbudsjettet</div>
      </div>
      <div class="comp-item">
        <div class="comp-value" id="compHospitals">â€”</div>
        <div class="comp-label">nye sykehus</div>
      </div>
      <div class="comp-item">
        <div class="comp-value" id="compSchools">â€”</div>
        <div class="comp-label">nye skoler</div>
      </div>
      <div class="comp-item">
        <div class="comp-value" id="compKm">â€”</div>
        <div class="comp-label">km motorvei</div>
      </div>
    </div>

    <!-- Felt-fordeling -->
    <div class="section-title">Bidrag per felt (estimert)</div>
    <div class="fields-grid" id="fieldsGrid"></div>

    <!-- Historisk -->
    <div class="historical">
      <div class="historical-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="var(--gold)" stroke-width="2">
          <circle cx="12" cy="12" r="9"/>
          <polyline points="12 7 12 12 15 14"/>
        </svg>
      </div>
      <div class="historical-text">
        Siden 1990: <strong>â‰ˆ 18 000 milliarder kroner</strong> til fellesskapet
      </div>
    </div>

    <!-- Footer -->
    <div class="footer-meta">
      <span class="meta-pill">KontantstrÃ¸m 2024: <strong>680 mrd kr</strong></span>
      <span class="meta-pill">Gasseksport: <strong>1 295 TWh</strong></span>
      <span class="meta-pill">Produksjon: <strong>241 mill SmÂ³ o.e.</strong></span>
    </div>
    <div class="footer-note">
      Illustrasjon basert pÃ¥ Ã¥rstall fordelt jevnt. Kilder: Statsbudsjettet, Sokkeldirektoratet, Gassco.
    </div>
  </div>

  <script>
    const CONFIG = {
      totalCashflow: 680000000000,
      pensionAnnual: 286000,
      kmAnnual: 1695481183600,
      lapsAnnual: 42307702.647536,
      householdsAnnual: 86333333,
      // Husstand-dager: 86,3 mill husstander Ã— 365 dager = 31,5 mrd husstand-dager
      householdDaysAnnual: 86333333 * 365,
      secondsInYear: 31622400,
      startSeconds: 23673600,
      statsBudget2024: 1692000000000,
      hospitalCost: 12000000000,
      schoolCost: 500000000,
      highwayCostPerKm: 300000000
    };

    const FIELDS = [
      { name: 'Johan Sverdrup', pct: 28 },
      { name: 'Troll', pct: 18 },
      { name: 'Oseberg', pct: 8 },
      { name: 'Ekofisk', pct: 7 },
      { name: 'SnÃ¸hvit', pct: 6 },
      { name: 'Ã…sgard', pct: 5 },
      { name: 'Grane', pct: 4 },
      { name: 'Statfjord', pct: 3 },
      { name: 'Gullfaks', pct: 3 },
      { name: 'Andre', pct: 18 }
    ];

    const rates = {
      tax: CONFIG.totalCashflow / CONFIG.secondsInYear,
      km: CONFIG.kmAnnual / CONFIG.secondsInYear,
      laps: CONFIG.lapsAnnual / CONFIG.secondsInYear,
      households: CONFIG.householdsAnnual / CONFIG.secondsInYear,
      householdDays: CONFIG.householdDaysAnnual / CONFIG.secondsInYear
    };

    let acc = {
      tax: CONFIG.totalCashflow * (CONFIG.startSeconds / CONFIG.secondsInYear),
      km: CONFIG.kmAnnual * (CONFIG.startSeconds / CONFIG.secondsInYear),
      laps: CONFIG.lapsAnnual * (CONFIG.startSeconds / CONFIG.secondsInYear),
      households: CONFIG.householdsAnnual * (CONFIG.startSeconds / CONFIG.secondsInYear),
      householdDays: CONFIG.householdDaysAnnual * (CONFIG.startSeconds / CONFIG.secondsInYear)
    };

    let milestones = { p: 0, l: 0, h: 0 };

    const el = {
      money: document.getElementById('money'),
      pensions: document.getElementById('pensions'),
      taxDelta: document.getElementById('taxDelta'),
      pensionDelta: document.getElementById('pensionDelta'),
      km: document.getElementById('km'),
      laps: document.getElementById('laps'),
      wowOsloTrd: document.getElementById('wowOsloTrd'),
      hhCount: document.getElementById('hhCount'),
      hhPct: document.getElementById('hhPct'),
      hhDelta: document.getElementById('hhDelta'),
      hhDays: document.getElementById('hhDays'),
      hhDaysDelta: document.getElementById('hhDaysDelta'),
      compBudget: document.getElementById('compBudget'),
      compHospitals: document.getElementById('compHospitals'),
      compSchools: document.getElementById('compSchools'),
      compKm: document.getElementById('compKm'),
      fieldsGrid: document.getElementById('fieldsGrid'),
      toast: document.getElementById('toast')
    };

    const fmt = {
      nok: n => new Intl.NumberFormat('nb-NO', { maximumFractionDigits: 0 }).format(Math.floor(n)) + ' kr',
      int: n => new Intl.NumberFormat('nb-NO', { maximumFractionDigits: 0 }).format(Math.floor(n)),
      dec: (n, d = 2) => n.toLocaleString('nb-NO', { minimumFractionDigits: d, maximumFractionDigits: d }),
      pct: n => n.toLocaleString('nb-NO', { minimumFractionDigits: 1, maximumFractionDigits: 1 }) + '%',
      millions: n => (n / 1e6).toLocaleString('nb-NO', { minimumFractionDigits: 1, maximumFractionDigits: 1 }) + ' mill',
      billions: n => (n / 1e9).toLocaleString('nb-NO', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ' mrd',
      short: n => {
        if (n >= 1e9) return (n / 1e9).toFixed(1).replace('.', ',') + ' mrd';
        if (n >= 1e6) return (n / 1e6).toFixed(1).replace('.', ',') + ' mill';
        return fmt.int(n);
      }
    };

    function render() {
      el.money.textContent = fmt.nok(acc.tax);
      el.pensions.textContent = fmt.int(acc.tax / CONFIG.pensionAnnual);
      
      el.taxDelta.textContent = '+' + fmt.nok(rates.tax) + '/s';
      // PensjonsÃ¥r per minutt
      const pensionsPerMin = (rates.tax * 60) / CONFIG.pensionAnnual;
      el.pensionDelta.textContent = '+' + fmt.dec(pensionsPerMin, 2) + ' /min';
      
      el.laps.textContent = fmt.dec(acc.laps, 1) + ' runder';
      el.km.textContent = fmt.int(acc.km) + ' km';
      const osloTrd = Math.floor(acc.km / 495);
      el.wowOsloTrd.textContent = fmt.int(osloTrd) + 'Ã— Osloâ€“Trondheim';
      
      // Husstander (Ã¥rsforbruk)
      el.hhCount.textContent = fmt.millions(acc.households);
      const euPct = (acc.households / 200000000) * 100;
      el.hhPct.textContent = fmt.pct(euPct) + ' av EU';
      el.hhDelta.textContent = '+' + fmt.dec(rates.households, 1) + ' /s';
      
      // Husstand-dager - vis faktiske tall sÃ¥ den tikker fortere
      el.hhDays.textContent = fmt.int(acc.householdDays);
      el.hhDaysDelta.textContent = '+' + fmt.int(rates.householdDays) + ' /s';
      
      const budgetPct = (acc.tax / CONFIG.statsBudget2024) * 100;
      el.compBudget.textContent = fmt.pct(budgetPct);
      el.compHospitals.textContent = fmt.int(acc.tax / CONFIG.hospitalCost);
      el.compSchools.textContent = fmt.int(acc.tax / CONFIG.schoolCost);
      el.compKm.textContent = fmt.int(acc.tax / CONFIG.highwayCostPerKm) + ' km';
      
      updateFields();
    }

    function updateFields() {
      el.fieldsGrid.innerHTML = FIELDS.map(f => `
        <div class="field-item">
          <div class="field-name">${f.name}</div>
          <div class="field-bar"><div class="field-bar-fill" style="width:${f.pct}%"></div></div>
          <div class="field-value">${fmt.short(acc.tax * f.pct / 100)} kr</div>
        </div>
      `).join('');
    }

    function checkMilestones() {
      const p = Math.floor(acc.tax / CONFIG.pensionAnnual);
      const l = Math.floor(acc.laps);
      const h = Math.floor(acc.households / 1000000);
      
      if (p > milestones.p && p % 100 === 0) {
        milestones.p = p;
        toast('ðŸŽ‰ ' + fmt.int(p) + ' pensjonsÃ¥r finansiert!');
      }
      if (l > milestones.l) {
        milestones.l = l;
        toast('ðŸŒ Runde ' + l + ' rundt ekvator!');
      }
      if (h > milestones.h) {
        milestones.h = h;
        toast('ðŸ  ' + h + ' mill husstander varmet!');
      }
    }

    function toast(msg) {
      el.toast.textContent = msg;
      el.toast.classList.add('show');
      setTimeout(() => el.toast.classList.remove('show'), 3000);
    }

    function shareLinkedIn() {
      const pensions = fmt.int(acc.tax / CONFIG.pensionAnnual);
      const url = window.location.href;
      window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}`, '_blank');
    }

    function openEmbed() { document.getElementById('embedModal').classList.add('show'); }
    function closeEmbed() { document.getElementById('embedModal').classList.remove('show'); }
    function copyEmbed() {
      document.getElementById('embedCode').select();
      document.execCommand('copy');
      toast('âœ“ Kopiert!');
    }
    document.getElementById('embedModal').addEventListener('click', e => {
      if (e.target.id === 'embedModal') closeEmbed();
    });

    milestones = {
      p: Math.floor(acc.tax / CONFIG.pensionAnnual),
      l: Math.floor(acc.laps),
      h: Math.floor(acc.households / 1000000)
    };

    render();

    setInterval(() => {
      acc.tax += rates.tax;
      acc.km += rates.km;
      acc.laps += rates.laps;
      acc.households += rates.households;
      acc.householdDays += rates.householdDays;
      render();
      checkMilestones();
      el.money.classList.remove('pulse');
      void el.money.offsetWidth;
      el.money.classList.add('pulse');
    }, 1000);
  </script>
</body>
</html>
